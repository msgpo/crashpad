add_library(compat OBJECT)
crashpad_set_props(compat)
target_link_libraries(compat PRIVATE crashpad_common)

if(UNIX AND NOT APPLE)
  target_include_directories(compat PUBLIC linux)
  target_sources(compat
    PRIVATE
    linux/sys/mman.cc
  )
else()
  target_include_directories(compat PUBLIC non_elf)
endif()

if(NOT WIN)
  target_include_directories(compat PUBLIC non_win)
endif()

if(WIN)
  target_include_directories(compat PUBLIC win)
  target_sources(compat
    PRIVATE
    win/getopt.h
    win/strings.cc
    win/strings.h
    win/sys/types.h
    win/time.cc
    win/time.h
    win/winbase.h
    win/winnt.h
    win/winternl.h
  )
endif()

if(APPLE)
  target_include_directories(compat PUBLIC mac)
else()
  target_include_directories(compat PUBLIC non_mac)
endif()